<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="msapplication-tap-highlight" content="no" />
    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width" />
    <!-- This is a wide open CSP declaration. To lock this down for production, see below. -->
    <meta http-equiv="Content-Security-Policy" content="default-src * 'unsafe-inline'; style-src 'self' 'unsafe-inline'; media-src *" />


    <link rel="stylesheet" type="text/css" href="css/index.css" />
    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/jquery.mobile-1.4.5.min.js"></script>
    <link rel="stylesheet" type="text/css" href="js/jquery.mobile-1.4.5.min.css" />

	<script type="text/javascript">
  $(window).load(function(){

                var onSuccess = function(position) {
                    $.ajax({
                      method: "GET",
                      url: "http://api.openweathermap.org/data/2.5/weather",
                      data: { lat: position.coords.latitude.toFixed(3), lon: position.coords.longitude.toFixed(3)  , mode: "html", APPID: "087e6090743bf9b2f00587e520d45363"}
                    })
                      .done(function( text ) {
                        
                        var divs = $(text).find("div");
                        $("#weather_info").html(divs);
                        $("#weather_info div:nth-of-type(2)").css("float","");
                        
                    });
                };

                 function onError(error) {
                    alert('code: '    + error.code    + '\n' +
                          'message: ' + error.message + '\n');
                 }

                navigator.geolocation.getCurrentPosition(onSuccess, onError);
                
    $("#get_weather").click(function(){
           navigator.geolocation.getCurrentPosition(onSuccess, onError);
    });
	});
	</script>
    
    <title>Pogoda</title>
</head>

<body>
    <div data-role="page">
    	<div data-role="header">
    		<h1><button id="get_weather">Sprawdź pogodę</button></h1>
    	</div>
    		<p id="weather_info"></p>
    </div>
    <script type="text/javascript" src="cordova.js"></script>
    <script type="text/javascript" src="js/index.js"></script>

</body>

</html>