<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="msapplication-tap-highlight" content="no" />
    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width" />
    <!-- This is a wide open CSP declaration. To lock this down for production, see below. -->
    <meta http-equiv="Content-Security-Policy" content="default-src * 'unsafe-inline'; style-src 'self' 'unsafe-inline'; media-src *" />


    <link rel="stylesheet" type="text/css" href="css/index.css" />
    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/jquery.mobile-1.4.5.min.js"></script>
    <link rel="stylesheet" type="text/css" href="js/jquery.mobile-1.4.5.min.css" />

	<script type="text/javascript">
	$(window).load(function(){
            $.ajax({
                type: "get",
                url: "uzytkownicy.txt",
                scriptCharset: "utf-8",
                contentType: "application/json; charset=utf-8",
                success: function(html) {
                            var users = JSON.parse(html);
                            var users_n  = users.uzytkownicy.length;
                            var table = "<div data-role='main' class='ui-content'><table data-role='table' data-mode='columntoggle' class='ui-responsive ui-shadow' id='myTable'><thead><tr><th data-priority='2'>Id</th><th>Imię</th></tr></thead><tbody>";
                            for(var i=0;i<users_n;i++){
                                table+="<tr><td>" + users.uzytkownicy[i].id_ + "</td><td>" + users.uzytkownicy[i].imie + "</td></tr>";
                            }
                            table+= "</tbody></table>";
                            $("#tabelka").html(table);

                        }
                });

        function get(){
            $.ajax({
                type: "get",
                url: "uzytkownicy.txt",
                scriptCharset: "utf-8",
                contentType: "application/json; charset=utf-8",
                success: function(html) {
                            var users = JSON.parse(html);
                            var users_n  = users.uzytkownicy.length;
                            var table = "<div data-role='main' class='ui-content'><table data-role='table' data-mode='columntoggle' class='ui-responsive ui-shadow' id='myTable'><thead><tr><th data-priority='2'>Id</th><th>Imię</th></tr></thead><tbody>";
                            for(var i=0;i<users_n;i++){
                                table+="<tr><td>" + users.uzytkownicy[i].id_ + "</td><td>" + users.uzytkownicy[i].imie + "</td></tr>";
                            }
                            table+= "</tbody></table>";
                            $("#tabelka").html(table);

                        }
                });
        }

            $("#add_user").click(function(){
                $.ajax({
                    type: "get",
                    url: "uzytkownicy.txt",
                    scriptCharset: "utf-8",
                    contentType: "application/json; charset=utf-8",
                    success: function(html) {
                                var users = JSON.parse(html);
                                var users_n  = users.uzytkownicy.length;
                                users.uzytkownicy.push({
                                    id_: users_n+1,
                                    imie: $("#imie").val()
                                });
                                alert(users.uzytkownicy[2].id_ + users.uzytkownicy[2].imie);
                                
                        }
                });
            });



    });
	</script>
    
    <title>Baza danych</title>
</head>

<body>
    <div data-role="page">
    	<div data-role="header">
    		<h1 id="header"><input type="text" name="imie" id="imie"><button id="add_user">Dodaj</button></h1>
    	</div>
    		<div id="tabelka"></div>
    </div>
    <script type="text/javascript" src="cordova.js"></script>
    <script type="text/javascript" src="js/index.js"></script>

</body>

</html>